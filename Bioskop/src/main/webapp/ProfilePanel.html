<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<link href="css/adminpanel.css" rel="stylesheet">

</head>
<body>
<div id="mySidenav" class="sidenav">
  <a href="#" onclick="admins()">Admins</a>
  <hr>
  <a href="#">Services</a>
  <hr>
  <a href="#">Clients</a>
  <hr>
  <a href="#">Contact</a>
</div>



<!-- Add all page content inside this div if you want the side nav to push page content to the right (not used if you only want the sidenav to sit on top of the page -->
<div id="main">
<div class="jumbotron" id="jumbotron" style="margin-left:200px;margin-right:0px;padding-left:0px;padding-top:-50px;margin-top:0px;">
	<div class="container" style="margin-top: 50px;" id="bodyAdmin">


  	</div>
</div>

<div class="modal fade" id="modal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal za dodavanje admina.-->
    <div class="modal-content">
      <div class="row centered-form">
      <div class="col-xs-12 col-sm-12 col-md-12 ">
      	<div class="panel panel-default">
      		<div class="panel-heading">
	    		<h3 class="panel-title">Please enter information about new admin </h3>
	 			</div>
	 			<div class="panel-body">
	    		<form role="form" id="form">
	    			<div class="row">
	    				<div class="col-xs-6 col-sm-6 col-md-6">
	    					<div class="form-group">
	                			<input type="text" name="firstName" id="firstName" class="form-control input-sm" placeholder="First Name">
	    					</div>
	    				</div>
	    				<div class="col-xs-6 col-sm-6 col-md-6">
	    					<div class="form-group">
	    						<input type="text" name="lastName" id="lastName" class="form-control input-sm" placeholder="Last Name">							    					</div>
	    				</div>
	    			</div>
	    			<div class="row">
	    			<div class="col-xs-6 col-sm-6 col-md-6" >
	    				<div class="form-group">
	    					<input type="email" name="email" id="email" class="form-control input-sm" placeholder="Email Address">
	    				</div>
	    			</div>
	    			<div class="col-xs-6 col-sm-6 col-md-6" >
	    				<div class="form-group">
	    					<input type="text" name="username" id="username" class="form-control input-sm" placeholder="Username">
	    				</div>
	    			</div>
	    			</div>
	    			<div class="row">


	    				<div class="col-xs-6 col-sm-6 col-md-6">
	    					<div class="form-group">
	    						<input type="text" name="city" id="city" class="form-control input-sm" placeholder="City">
	    					</div>
	    				</div>
	    				<div class="col-xs-6 col-sm-6 col-md-6">
	    					<div class="form-group">
	    						<input type="text" name="street" id="street" class="form-control input-sm" placeholder="Street" >
	    					</div>
	    				</div>
	    				<div class="col-xs-6 col-sm-6 col-md-6">
	    				
	    				      <label for="sel1">Select admin type:</label>
												  <select class="form-control" id="userType">
 													 	<option value="SYSTEMADMIN">System admin</option>
  													<option value="FANZONEADMIN">Fan zone admin</option>
  													<option value="CINEMAADMIN">Cinema admin</option>
											  </select>
										</div>
	    				
	    			<div class="col-xs-6 col-sm-6 col-md-6">
	    				<button  id="addAdmin" type="button" class="btn btn-info">Add new admin</button>
	    				
	    			</div>
	    			</div>
	    		</form>
	    	</div>
   		</div>
  		</div>
  	</div>	
  </div>
</div>
</div> 
</div>
</body>
<script>
var tableIndex = 1;
function admins(){
	$("#bodyAdmin").empty();
	$.ajax({
	    contentType: 'application/json',
	    dataType: 'json',
	    success: function(admins){
			$.get("adminTable.html", function( adminTable ) {
				  $("#bodyAdmin").append(adminTable);

				  admins.forEach(function(admin) {
						var tableData = '';
						tableData += '<tr><th scope="row">' + tableIndex + '</th>';
						tableData += '<td>'+ admin.firstName +'</td>';
						tableData += '<td>' + admin.lastName + '</td>';
						tableData += '<td>' + admin.username + '</td>';
						tableData += '<td>' + admin.email + '</td>';
						tableData += '<td>' + admin.userType + '</td></tr>';
						$("#tableBody").append(tableData);
						tableIndex++;
						
					});
				});
			
	    },
	    processData: false,
	    type: 'GET',
	    url: '/api/admins'
	});
}
function openNav() {
    document.getElementById("mySidenav").style.width = "250px";
}

/* Set the width of the side navigation to 0 */
function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
}

$("#addAdmin").click(function() {
	var person = {};
	 person.firstName = $("#firstName").val();
	 person.lastName = $("#lastName").val();
	 person.username = $("#username").val();
	 person.email = $("#email").val();
	 var address = { "city" : $("#city").val(),
			 		"street" : $("#street").val()};
	 
	 person["address"] = {};
	 person["address"] = address
	 person.password = $("#password").val();
	 person.userType = $("#userType").val();
	 
	$.ajax({
	    contentType: 'application/json',
	    data: JSON.stringify(person),
	    dataType: 'json',
	    success: function(admin){
			
	    	alert("Admin " + admin.username + " has been successfully added!");
			var tableData = '';
			tableData += '<tr><th scope="row">' + tableIndex + '</th>';
			tableData += '<td>'+ admin.firstName +'</td>';
			tableData += '<td>' + admin.lastName + '</td>';
			tableData += '<td>' + admin.username + '</td>';
			tableData += '<td>' + admin.email + '</td>';
			tableData += '<td>' + admin.userType + '</td></tr>';
			$("#tableBody").append(tableData);
			tableIndex++;

			$('#modal').modal('toggle');


	    },
	    error: function(data){
	    	alert("username already exists");
	    },
	    processData: false,
	    type: 'POST',
	    url: '/api/users'
	});
});
</script>


</html>
